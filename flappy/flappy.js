const n=0,e=1,t=2,o=480,c=640,w=11,a=.65,i=15,f=52,u=32,r=80,s=3,g=2,d=88,p=175,b=150,l=250,h=32,m=48,M=5;let I=0,j=document.getElementById("canvas"),D=j.getContext("2d"),O=new Object;const k=[new Object,new Object];let x,y,v=new Object,E=new Object,z=0,A=0,B=new Date,C=!1;function F(){q(),window.addEventListener("resize",(()=>{q()})),window.requestAnimationFrame(G),O.t=320,O.o=0,O.rotation=0,R(),S(),U(),window.addEventListener("keydown",(n=>{if(" "===n.key)C=!0})),navigator.maxTouchPoints>0?j.addEventListener("touchstart",(function(n){C=!0,n.preventDefault()})):j.addEventListener("mousedown",(function(){C=!0}))}function q(){let n=window.innerWidth-16,e=window.innerHeight-16;n>.75*e?(j.style.width=.75*e+"px",j.style.height=e+"px"):(j.style.width=n+"px",j.style.height=1.333*n+"px")}function G(){switch(x=new Date,y=(x-B)/(1e3/60),B=x,I){case 0:z=(z+3*y)%24,H(),C&&(L(y),I=1);break;case 1:z=(z+3*y)%24,P(y),L(y),N(),H(),T();break;case 2:O.t<544?(O.o=15,O.t+=15):C&&Q(),H(),T()}C=!1,window.requestAnimationFrame(G)}function H(){D.fillStyle="#67BEC6",D.fillRect(0,0,480,640),D.drawImage(E.background,0,380),D.fillStyle="#7ADE86",D.fillRect(0,530,480,45),K(),J(),D.fillStyle="#D9D18F",D.fillRect(0,560,480,80),D.drawImage(E.i,-z,560,504,28)}function J(){let n=O.t,e=E.u.width,t=E.u.height;O.rotation=-20,O.o>9&&(O.rotation=15*(O.o-9)),0==I&&(O.rotation=0),D.translate(240,n),D.rotate(O.rotation*Math.PI/180),D.drawImage(E.u,-e/2,-t/2,e,t),D.rotate(-O.rotation*Math.PI/180),D.translate(-240,-n)}function K(){for(let n=0;n<2;n++)D.drawImage(E.g,k[n].position-4,640-k[n].height,96,40),D.scale(1,-1),D.drawImage(E.g,k[n].position-4,-(640-k[n].height-175),96,40),D.scale(1,-1),D.drawImage(E.p,k[n].position,640-k[n].height+40,88,k[n].height-80),D.drawImage(E.p,k[n].position,0,88,640-k[n].height-175-40)}function L(n){C?O.o=-11:(O.o+=.65*n,O.o>15&&(O.o=15)),O.t+=O.o*n}function N(){for(let n=0;n<2;n++)k[n].position<266&&k[n].position>126&&(O.t>640-k[n].height-16||O.t<640-(k[n].height+175)+16)&&(I=2);O.t>544&&(I=2)}function P(n){for(let e=0;e<2;e++)k[e].position-=3*n,k[e].position+44+3*n>=240&&k[e].position+44<240&&A++,k[e].position<-96&&(k[e].position=488-(-k[e].position-88+8)%568,k[e].height=150+Math.floor(250*Math.random()))}function Q(){I=0,O.t=320,O.o=0,O.rotation=0,R(),A=0}function R(){for(let n=0;n<2;n++)k[n].position=960+288*n,k[n].height=150+Math.floor(250*Math.random())}function S(){v.width=8,v.height=12,v.l=new Image,v.l.src="res/font.png"}function T(){const n=A.toString();let e=Math.floor(240-(32*n.length+5*(n.length-1))/2);for(let t=0;t<n.length;t++)D.drawImage(v.l,32*(n.charCodeAt(t)-48),0,32,48,e+37*t,60,32,48)}function U(){E.u=new Image,E.u.src="res/flappy1.png",E.background=new Image,E.background.src="res/background.png",E.i=new Image,E.i.src="res/ground.png",E.p=new Image,E.p.src="res/tubebody.png",E.g=new Image,E.g.src="res/tubetop.png"}F();